#include  "uvebase.inc"
#include  "repair.inc"
import    "xlm.exp"

name      "Malware-fortest-1.3.0"
record    6
dtype     MCS_DTYPE_UNKNOWN, MCS_DTYPE_PHONE
virustype MCS_VTYPE_MALWARE
sclass    TCS_SC_TERMINAL
blevel    TCS_BC_LEVEL3


MATCH_PATTERN:
    mov 12eh, DP
    lea PATTERN, r0
    swi UVE_SWI_STRLEN
    lea PATTERN, r1
    lea WILDCARD, r2
    SET_ZERO(r3)
    mov r0, r4
    
    qsearchi r1, r0, r2, r3, r4
    setvariant "Variant-fortest-1.3.0"
    
CheckVirusFound:
    test FL, UVE_FL_VIRUSFOUND
    JZ Quit
    CheckRepairFlag(Clean)
Quit:
    exit
Clean:
    calli CleanScannedFile
    exit

PATTERN:
bdata ("+000 555 5555", 0)

WILDCARD:
bdata ("*?")
